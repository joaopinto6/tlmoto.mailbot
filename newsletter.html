<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter Signup</title>
</head>
<body>

<h2>Subscribe to Our Newsletter</h2>

<form id="newsletterForm" onsubmit="return submitForm()">
    <label for="email">Email:</label>
    <input type="email" id="email" name="Email" required>
    <button type="submit">Subscribe</button>
</form>
<script>
    async function submitForm() {
        // Prevent default form submission
        event.preventDefault();

        // Get the form data
        var formData = new FormData(document.getElementById("newsletterForm"));

        try {
              // Send the form data using Fetch API with await
              const response = await fetch('https://script.google.com/macros/s/AKfycbzGX7rhxmR6IHxh6YCp1Mp-DrGw_cihKYlQtzgg-L-x6Y0RCOHacTrYSVvWqJnfFL1v/exec', {
                  method: 'POST',
                  body: formData
              });

              if (response.ok) {
                  // Form submission successful
                  console.log("email added");
              } else {
                  // Handle errors
                  console.error('Failed to submit form:', response.status);
              }
          } catch (error) {
              // Handle network errors
              console.error('Error submitting form:', error);
          }

        return false; // Prevent actual form submission
    }
</script>

</body>
</html>
